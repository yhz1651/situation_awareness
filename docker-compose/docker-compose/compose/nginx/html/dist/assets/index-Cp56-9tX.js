import{r as e,j as s,u as t,a,S as n}from"./index-BHzTjgdo.js";import{g as i,i as l,u as r,a as o,b as c,c as d,d as m,e as u,f as h,h as x,j}from"./installCanvasRenderer--QmpqVAe.js";import{r as p,g as f,G as y,S as g,B as v}from"./index-Di44d5Sh.js";import{M as S}from"./index-DJDkQNUc.js";import{T as k,g as b}from"./situation-DgN_xpIM.js";import{S as E}from"./index-CTlTgMjl.js";import{B as N,L as C}from"./request-BdSZPrdh.js";import{a as w,t as _,g as I}from"./assessment-B8y50_jM.js";import{M as D}from"./index-D-Niv0xz.js";import{S as A}from"./index-CcU0Nfwo.js";import"./index-DbH9RyqW.js";import"./EyeOutlined-DPMoqjW0.js";import"./index-De03Z11V.js";import"./Tile-B_8rgVKG.js";const L="_root_e1q1j_1";function B({LieStackData:t}){const a=e.useRef(),n={color:["#FE9A01","#00CB78","#77E9FF"],legend:{data:t.lineStackLegendData},grid:{left:"3%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.lineStackXaxisData,name:t.Xname||"",axisLabel:{margin:16},nameGap:10},yAxis:{type:"value",max:t.max||null,name:t.Yname||"",nameGap:10,offset:t.yAxisoffset||null,nameTextStyle:{shadowOffsetX:30}},series:t.lineStackSeriesData};return e.useEffect((()=>{let e=i(a.current);null==e&&(e=l(a.current)),e.setOption(n)})),s.jsx("div",{style:{height:220},ref:a})}function T({LieStackData:e,showEvaluation:t,setShowEvaluation:a}){const n=()=>{a(!1)},i=[];for(let l=0;l<4;l++)i.push({key:l,name:"局部战力优势",age:"x"+(11+10*l),address:l<2?s.jsxs("span",{children:["x",12+10*l,s.jsx("img",{style:{marginLeft:15},src:p,alt:""})]}):s.jsxs("span",{children:["x",12+10*l,s.jsx("img",{style:{marginLeft:15},src:f,alt:""})]})});return s.jsxs(S,{width:440,wrapClassName:"Evaluation",open:t,onOk:()=>{a(!1)},onCancel:n,footer:null,closeIcon:!1,children:[s.jsx("div",{className:"title",children:"量化评估"}),s.jsxs("div",{className:"Evaluation_content",children:[s.jsx(B,{LieStackData:e}),s.jsx(k,{pagination:!1,dataSource:i,columns:[{title:"指标",dataIndex:"name",key:"name"},{title:"敌方",dataIndex:"age",key:"age"},{title:"我方",dataIndex:"address",key:"address"}]}),s.jsx("div",{className:"button_content",children:s.jsxs(E,{size:40,children:[s.jsx(N,{type:"primary",style:{width:80,height:30,backgroundColor:"#E2EFFA",color:"#006BC3"},children:"导出"}),s.jsx(N,{onClick:n,type:"primary",style:{width:80,height:30,color:" rgba(0,0,0,0.4)",backgroundColor:"#EBEBEB"},children:"返回"})]})})]})]})}function O({LieStackData:t,showSuperbiseResoult:a,setShowSuperbiseResoult:n}){const i=()=>{n(!1)},l=[];for(let e=0;e<4;e++)l.push({key:e,name:"环境异常监管告警",age:16,address:"424954, 834794",code:s.jsx("span",{style:{color:"red"},children:"'W101：禁入区域'"})});e.useState([]);return s.jsxs(S,{width:1194,wrapClassName:"Evaluation",open:a,onOk:()=>{n(!1)},onCancel:i,footer:null,closeIcon:!1,children:[s.jsx("div",{className:"title",children:"态势监管结果"}),s.jsx("div",{className:"list_content",children:[{name:"态势编号：TS001"},{name:"态势名称：未命名1"},{name:"态势归属：湖北陆战场"},{name:"创建人：席x"},{name:"创建时间：2023.12.07 16:2"}].map(((e,t)=>s.jsx(E,{size:50,children:s.jsx("div",{className:"list_item",children:e.name})},t)))}),s.jsxs("div",{className:"Evaluation_content",children:[s.jsx(B,{LieStackData:t}),s.jsx("div",{className:"table_content",children:s.jsx(k,{pagination:!1,dataSource:l,columns:[{title:"监管结果",dataIndex:"name",key:"name"},{title:"时间戳",dataIndex:"age",key:"age"},{title:"坐标",dataIndex:"address",key:"address"},{title:"警告代码",dataIndex:"code",key:"code"}]})}),s.jsx("div",{className:"button_content",children:s.jsxs(E,{size:40,children:[s.jsx(N,{type:"primary",style:{width:80,height:30,backgroundColor:"#E2EFFA",color:"#006BC3"},children:"结果反馈"}),s.jsx(N,{onClick:i,type:"primary",style:{width:80,height:30,color:" rgba(0,0,0,0.4)",backgroundColor:"#EBEBEB"},children:"返回"})]})})]})]})}function F(){const i=t(),{fileAddress:l,taishiInfo:r}=a()?.state||{fileAddress:null,taishiInfo:null},[o,c]=e.useState({}),{setLoading:d,loading:m,fileData:u,coordinates:h,entityData:x,entityIndex:j,setEntityIndex:p,currentEntity:f,setTaishiNmame:S,taishiNmame:k,currentTimeEntity:B,setCurrentTimeEntity:F,currentTimeIndex:z,setCurrentTimeIndex:R,setCurrentEntity:V}=y(),[G,X]=e.useState(1),[q,J]=e.useState({}),[M,P]=e.useState([]);e.useEffect((()=>{(async()=>{const{data:e}=await b();J(e.data.records[0]);let s=[];for(let t=0;t<e.data.records.length;t++){const a=e.data.records[t];s.push({key:t,value:a.fileAddress,label:a.name,...a})}P(s),l?(S(l),c(r)):(S(s[0].value),c(s[0]))})(),S(l),d(!1)}),[l]);const[W,Y]=e.useState(!1),[H,K]=e.useState(!1);e.useState(!1);const[Q,U]=e.useState([]),Z=async e=>{try{d(!0);const{data:s}=await _([{entity_id:e,data:u}]);d(!1);let t=s.y_hat.replace(/"/g,"");if(JSON.parse(t))return JSON.parse(t)}catch(s){d(!1)}},[$,ee]=e.useState([]),[se,te]=e.useState([]),ae=async e=>{try{X(1),d(!0);const{data:s}=await I({file_name:l,target_entity_name:e});let t=s.data;return d(!1),t}catch(s){d(!1)}};return s.jsxs("div",{className:L,children:[s.jsxs("div",{className:"Compute_content",children:[s.jsxs("div",{className:"Compute_header",children:[s.jsx("div",{className:"left",children:s.jsxs(E,{size:30,children:[s.jsxs("div",{className:"select",children:[s.jsx("span",{className:"select_title",children:"选择态势："}),s.jsx(A,{placeholder:"请选择",onChange:e=>{S(e);let s=M.filter((s=>s.fileAddress==e));c(s[0])},options:M,style:{width:120}})]}),s.jsxs("div",{className:"select",children:[s.jsx("span",{className:"select_title",children:"显示方式："}),s.jsx(A,{value:G,onChange:e=>{X(e),V([h[0]]),F(u[0].entities),R([0]),p([0])},options:[{value:0,label:"时间切片"},{value:1,label:"运动轨迹"}],style:{width:120}})]}),0===G&&s.jsxs("div",{className:"select",children:[s.jsx("span",{className:"select_title",children:"时间选择："}),s.jsx(A,{defaultValue:z,onChange:e=>{R(e),F(u[e].entities)},options:u.map(((e,s)=>({label:e.time,value:s}))),style:{width:120}})]}),1===G&&s.jsxs("div",{className:"select",children:[s.jsx("span",{className:"select_title",children:"实体选择："}),s.jsx(A,{mode:"multiple",defaultValue:j,onChange:e=>{p(e);let s=[];for(let t=0;t<e.length;t++)s.push(h[e[t]]);V(s)},options:x.map(((e,s)=>({label:e[0].name,value:s}))).filter((e=>"Virtual"!==e.label?.substring(0,7))),style:{width:300}})]})]})}),s.jsx("div",{className:"right",children:s.jsxs(E,{size:30,children:[s.jsx(N,{onClick:async()=>{try{X(0),d(!0);const{data:e}=await w(u),s={};e.abnormal_entities.forEach((e=>{const t=e.time_slice;s[t]||(s[t]=[]),s[t].push(e)}));const t=Object.values(s);ee(t[z]),d(!1)}catch(e){d(!1)}},children:"异常检测"}),s.jsx(N,{onClick:()=>{U([]),te([]),X(1);let e=[];for(let s=0;s<j.length;s++)e.push(Z(j[s]));Promise.all(e).then((e=>{let s=e.filter((e=>void 0!==e));U(s)})),ee([])},children:"自动推理"}),s.jsx(N,{onClick:()=>{te([]),U([]);let e=[];for(let s=0;s<j.length;s++)e.push(ae(x[j[s]][0].name));Promise.all(e).then((e=>{te(e)})),d(!1)},children:"意图识别"}),s.jsx(g,{situation:q,fileData:u}),s.jsx(N,{onClick:()=>{i("/situationAssessment",{state:{fileAddress:l}})},children:"量化评估"})]})})]}),s.jsxs("div",{className:"map",children:[s.jsx(n,{spinning:m,indicator:s.jsx(C,{spin:!0}),size:"large",children:s.jsx("div",{className:"map_content",children:s.jsx(D,{predictData:1==G?Q:null,coordinates:1==G?f:null,currentTimeEntity:0==G?B.filter((e=>"Virtual"!==e.name?.substring(0,7))):null,abnormalData:0==G?$.filter((e=>"Virtual"!==e.name?.substring(0,7))):null,generateData:1==G?se:null})})}),s.jsx(v,{taishiInfo:o})]})]}),s.jsx(T,{showEvaluation:W,setShowEvaluation:Y}),s.jsx(O,{showSuperbiseResoult:H,setShowSuperbiseResoult:K})]})}r([o,c,d,m,u,h,x,j]);export{F as default};
