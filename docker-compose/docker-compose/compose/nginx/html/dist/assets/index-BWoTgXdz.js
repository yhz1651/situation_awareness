import{r as e,j as t,S as s}from"./index-BHzTjgdo.js";import{M as i}from"./index-D-Niv0xz.js";import{b as a,t as n,a as o}from"./assessment-B8y50_jM.js";import{U as r}from"./index-Bac-UI3j.js";import{B as l,L as c,s as m}from"./request-BdSZPrdh.js";import{S as d}from"./index-CTlTgMjl.js";import{S as u}from"./index-CcU0Nfwo.js";import"./Tile-B_8rgVKG.js";import"./EyeOutlined-DPMoqjW0.js";const h="_root_h31t1_1";function p(){const p={name:"file",action:"/api/upload",headers:{authorization:"authorization-text"},onChange(e){e.file.status,"done"===e.file.status?(x(e.file.response.file_name),m.success(`${e.file.name} 上传成功`)):"error"===e.file.status&&m.error(`${e.file.name} 上传失败`)}},[f,j]=e.useState(!1),x=e=>{localStorage.setItem("taiShiName",e)},[S,g]=e.useState(null);e.useEffect((()=>{(async()=>{j(!0);const e=localStorage.getItem("taiShiName");if(!e)return m.error("请先上传态势文件");const{data:t}=await a({file_name:e}),s=t;g(s);const i=[],n=[];for(let a=0;a<s[0].entities.length;a++)i.push([]),n.push([]);for(let a=0;a<s.length;a++)for(let e=0;e<s[a].entities.length;e++)i[e].push({name:s[a].entities[e].name,enemy:s[a].entities[e].enemy,environment:s[a].entities[e].environment,policy:s[a].entities[e].policy,temperature:s[a].entities[e].temperature,coordinates:[s[a].entities[e].location.longitude,s[a].entities[e].location.latitude],longitude:s[a].entities[e].location.longitude}),n[e].push([s[a].entities[e].location.longitude,s[a].entities[e].location.latitude]);b(i),_(n),I(n[0]),j(!1)})()}),[]);const[y,v]=e.useState([]),[N,_]=e.useState([]),[z,b]=e.useState([]),[w,C]=e.useState(0),[k,I]=e.useState([]);e.useState([]);const q=e=>{if(!localStorage.getItem("taiShiName"))return m.error("请先上传态势文件");"abnormal"===e&&(async e=>{const{data:t}=await o(e)})(S)};return t.jsxs("div",{className:h,children:[t.jsxs("div",{className:"header",children:[t.jsx(r,{...p,children:t.jsx(l,{children:"上传态势"})}),t.jsxs(d,{size:20,children:[t.jsxs(d,{size:20,children:[t.jsx("span",{children:"选择实体："}),t.jsx(u,{style:{width:120},value:w,options:z.map(((e,t)=>({label:e[0].name,value:t}))),onChange:e=>{C(e),I(N[e])}})]}),t.jsx(d,{size:20}),t.jsx(l,{onClick:async()=>{if(!S)return m.error("请先上传态势文件");j(!0);const{data:e}=await n([{entity_id:w,data:S}]);j(!1);let t=e.y_hat.replace(/"/g,"");v(JSON.parse(t))},children:"预测"}),t.jsx(l,{onClick:()=>q("abnormal"),children:"判断异常"})]})]}),t.jsx(s,{spinning:f,indicator:t.jsx(c,{spin:!0}),size:"large",children:t.jsx("div",{className:"content",children:t.jsx(i,{predictData:y,coordinates:k})})})]})}export{p as default};
