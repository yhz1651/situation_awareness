import{r as e,A as s,_ as t,u as a,j as i,C as l}from"./index-BHzTjgdo.js";import{T as n,a as o,u as r,d,g as c,b as m}from"./situation-DgN_xpIM.js";import{s as h}from"./assessment-B8y50_jM.js";import{g as x,B as u,s as f}from"./request-BdSZPrdh.js";import{F as j,I as p}from"./index-DbH9RyqW.js";import{S as g}from"./index-CTlTgMjl.js";import{P as y}from"./PlusOutlined-D0ojogT-.js";import{M as b}from"./index-DJDkQNUc.js";import{U as v}from"./index-Bac-UI3j.js";import"./index-CcU0Nfwo.js";import"./index-De03Z11V.js";import"./EyeOutlined-DPMoqjW0.js";const C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};var F=function(a,i){return e.createElement(s,t({},a,{ref:i,icon:C}))};const S=e.forwardRef(F),w="_root_519fa_1";function I(){const s=a();e.useState([]);const[t]=j.useForm(),[C,F]=e.useState(!1),I=()=>{F(!1),t.resetFields()},[k,N]=e.useState("新增态势"),_=[{title:"态势编号",dataIndex:"createTime"},{title:"态势名称",dataIndex:"name"},{title:"态势归属",dataIndex:"belong"},{title:"创建时间",dataIndex:"createTime",render:e=>d(e).format("YYYY-MM-DD HH:mm")},{title:"创建人",dataIndex:"createUser"},{title:"模拟状态",dataIndex:"simulationStatus",render:e=>1===e?i.jsx("span",{style:{color:"#0097FF"},children:"已模拟"}):i.jsx("span",{style:{color:"red"},children:"未模拟"})},{title:i.jsx("div",{style:{textAlign:"center"},children:"操作"}),dataIndex:"operation",width:200,render:(e,t)=>i.jsxs(g,{size:20,children:[i.jsx(u,{onClick:()=>L(t),type:"text",style:{fontSize:16,color:"#0097FF"},children:"编辑"}),i.jsx(u,{onClick:()=>s("/visual",{state:{fileAddress:t.fileAddress,taishiInfo:t}}),type:"text",style:{fontSize:16,color:"#0097FF"},children:"可视化"}),i.jsx(u,{onClick:()=>P(t),style:{fontSize:16,color:"#0097FF"},type:"text",children:"模拟数据"}),i.jsx(u,{onClick:()=>U(t),type:"text",style:{color:"red",fontSize:16},children:"删除"})]})}],[z,A]=e.useState([]),[E,B]=e.useState(1),[T,M]=e.useState(null),[V,H]=e.useState(20),O=async()=>{const{data:e}=await c({pageNum:E,pageSize:V});A(e.data.records),M(e.data.total)},[Y,q]=e.useState({}),L=e=>{q(e),N("编辑态势");const{name:s,belong:a,description:i}=e;t.setFieldsValue({name:s,belong:a,description:i}),F(!0)};e.useEffect((()=>{O()}),[V,E]);const D={name:"file",action:"/api/upload",headers:{authorization:"authorization-text",Token:x()},onChange(e){e.file.status,"done"===e.file.status||e.file.status}},P=async e=>{let s={...e};const{data:t}=await h({file_name:e.fileAddress});let a=t.file_name;if(t.message){delete s.fileAddress,delete s.simulationStatus;const{data:e}=await r({...s,fileAddress:a,simulationStatus:1});0==e.code&&(f.success("模拟数据成功",.5),O())}},U=async e=>{b.confirm({title:"删除",content:"确定删除吗？",okText:"确定",cancelText:"取消",onOk:async()=>{const{data:s}=await m([e.id]);0==s.code&&(f.success("删除成功",.5),O())}})};return i.jsxs("div",{className:w,children:[i.jsxs("div",{className:"Modeling_content",children:[i.jsxs("div",{className:"top",children:[i.jsx("div",{className:"title",children:"态势建模"}),i.jsx("div",{className:"right_operaiton",children:i.jsx(g,{size:26,children:i.jsx(u,{onClick:()=>{N("新增态势"),F(!0)},icon:i.jsx(y,{}),children:"新建态势"})})})]}),i.jsx("div",{className:"table_content",children:i.jsx("div",{className:"table_bg",children:i.jsx(n,{rowKey:e=>e.id,style:{padding:10},columns:_,dataSource:z,pagination:{showQuickJumper:!0,total:T,current:E,onChange:(e,s)=>{B(e),H(s)}}})})})]}),i.jsx("div",{className:"modal",children:i.jsxs(b,{wrapClassName:"modeling_modal",style:{padding:0},open:C,onOk:()=>{F(!1)},onCancel:I,width:438,footer:null,closeIcon:!1,children:[i.jsx("div",{className:"title",children:k}),i.jsxs("div",{className:"from_content",children:[i.jsx("div",{className:"title_1",children:"态势信息录入"}),i.jsx(l,{theme:{components:{Form:{itemMarginBottom:14,algorithm:!0},Button:{contentLineHeight:"28px"}}},children:i.jsxs(j,{name:"basic",form:t,onFinish:async e=>{if("新增态势"===k){const{data:s}=await o({...e});0===s.code&&(f.success("添加成功"),O(),t.resetFields(),F(!1))}if("编辑态势"===k){const{data:s}=await r({...e,id:Y.id});0===s.code&&(f.success("编辑成功"),t.resetFields(),F(!1))}},children:[i.jsx(j.Item,{name:"name",labelCol:{offset:2},label:"态势名称：",children:i.jsx(p,{placeholder:"请输入"})}),i.jsx(j.Item,{name:"belong",labelCol:{offset:2},label:"态势归属：",children:i.jsx(p,{placeholder:"请输入"})}),i.jsx(j.Item,{name:"description",labelCol:{offset:2},label:"描述：",children:i.jsx(p,{placeholder:"请输入"})}),i.jsx("div",{className:"file",children:i.jsx(j.Item,{label:"态势文件上传：",name:"fileAddress",getValueFromEvent:e=>e.fileList[0]?.response?.file_name||"",validateTrigger:"onSubmit",rules:[{required:!0,message:"请导入文件"}],variant:"borderless",layout:"inline",labelCol:{span:17},children:i.jsx(v,{...D,children:i.jsx(u,{icon:i.jsx(S,{}),children:"文件上传"})})})}),i.jsx(j.Item,{wrapperCol:{offset:7,span:16},children:i.jsxs(g,{size:40,children:[i.jsx(u,{type:"primary",htmlType:"submit",style:{width:80,height:30,backgroundColor:"#E2EFFA",color:"#006BC3"},children:"确定"}),i.jsx(u,{onClick:I,type:"primary",style:{width:80,height:30,color:" rgba(0,0,0,0.4)",backgroundColor:"#EBEBEB"},children:"取消"})]})})]})})]})]})})]})}export{I as default};
