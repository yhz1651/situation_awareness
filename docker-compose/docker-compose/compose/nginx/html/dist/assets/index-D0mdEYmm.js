import{r as e,j as s,S as t}from"./index-BHzTjgdo.js";import{M as a}from"./index-D-Niv0xz.js";import{b as i,a as n}from"./assessment-B8y50_jM.js";import{U as r}from"./index-Bac-UI3j.js";import{B as o,L as l,s as c}from"./request-BdSZPrdh.js";import{S as m}from"./index-CTlTgMjl.js";import{S as d}from"./index-CcU0Nfwo.js";import"./Tile-B_8rgVKG.js";import"./EyeOutlined-DPMoqjW0.js";const u="_root_h31t1_1";function j(){const j={name:"file",action:"/api/upload",headers:{authorization:"authorization-text"},onChange(e){e.file.status,"done"===e.file.status?(x(e.file.response.file_name),c.success(`${e.file.name} 上传成功`)):"error"===e.file.status&&c.error(`${e.file.name} 上传失败`)}},[f,h]=e.useState(!1),x=e=>{localStorage.setItem("taiShiName",e)},[p,S]=e.useState([]),[g,_]=e.useState([]),[v,z]=e.useState([]),[N,b]=e.useState(0);e.useEffect((()=>{(async()=>{h(!0);const e=localStorage.getItem("taiShiName");if(!e)return c.error("请先上传态势文件");const{data:s}=await i({file_name:e}),t=s;S(t),_(t[0].entities),h(!1)})()}),[]);const[y,E]=e.useState([]),w=()=>{if(!localStorage.getItem("taiShiName"))return c.error("请先上传态势文件");(async e=>{const{data:s}=await n(e),t={};s.abnormal_entities.forEach((e=>{const s=e.time_slice;t[s]||(t[s]=[]),t[s].push(e)}));const a=Object.values(t);E(a[N])})(p)};return s.jsxs("div",{className:u,children:[s.jsxs("div",{className:"header",children:[s.jsx(r,{...j,children:s.jsx(o,{children:"上传态势"})}),s.jsxs(m,{size:20,children:[s.jsxs(m,{size:20,children:[s.jsx("span",{children:"选择时间："}),s.jsx(d,{style:{width:150},options:p.map(((e,s)=>({label:e.time,value:s}))),value:N,onChange:e=>{z(p[e].entities),b(e)}})]}),s.jsx(m,{size:20}),s.jsx(o,{onClick:()=>w(),children:"异常检测"})]})]}),s.jsx(t,{spinning:f,indicator:s.jsx(l,{spin:!0}),size:"large",children:s.jsx("div",{className:"content",children:s.jsx(a,{currentTimeEntity:g,abnormalData:y})})})]})}export{j as default};
